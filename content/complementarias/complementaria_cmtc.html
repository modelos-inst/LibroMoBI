
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Complementaria 7: Cadenas de Markov en Python I &#8212; Libro Modelado de Sistemas Bajo Incertidumbre - IIND 2504</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=003d74d7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/complementarias/complementaria_cmtc';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Complementaria Semana 8: Simulación de un Proceso de Poisson" href="complementaria_simu_proceso_poisson.html" />
    <link rel="prev" title="Complementaria 5: Cálculo de filas" href="complementaria_filas.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/uniandes.png" class="logo__image only-light" alt="Libro Modelado de Sistemas Bajo Incertidumbre - IIND 2504 - Home"/>
    <script>document.write(`<img src="../../_static/uniandes.png" class="logo__image only-dark" alt="Libro Modelado de Sistemas Bajo Incertidumbre - IIND 2504 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Bienvenidos al libro del curso Modelado de Sistemas Bajo Incertidumbre
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Complementarias</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial. Instalación Python y Visual Studio Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="ambientes_virtuales.html">Ambientes virtuales en Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="complementaria_intro_python.html">Complementaria 1: Introducción a Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="complementaria_intro_montecarlo.html">Complementaria 2: Introducción a la simulación de Montecarlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="complementaria_tlc.html">Complementaria 3: Teorema del Límite Central y validación empírica</a></li>
<li class="toctree-l1"><a class="reference internal" href="complementaria_filas.html">Complementaria 5: Cálculo de filas</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Complementaria 7: Cadenas de Markov en Python I</a></li>
<li class="toctree-l1"><a class="reference internal" href="complementaria_simu_proceso_poisson.html">Complementaria Semana 8: Simulación de un Proceso de Poisson</a></li>






</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/complementarias/complementaria_cmtc.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Complementaria 7: Cadenas de Markov en Python I</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parte-1-ejercicio-guiado">Parte 1: Ejercicio Guiado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parte-2-ejercicio-aplicado">Parte 2: Ejercicio Aplicado</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preguntas-de-profundizacion">Preguntas de Profundización</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="complementaria-7-cadenas-de-markov-en-python-i">
<h1>Complementaria 7: Cadenas de Markov en Python I<a class="headerlink" href="#complementaria-7-cadenas-de-markov-en-python-i" title="Link to this heading">#</a></h1>
<p>Una cadena de Márkov es un proceso estocástico que describe el estado de un sistema a través de una variable de estado que, a partir de un estado inicial, realiza transiciones entre distintos estados, siempre dentro de un espacio de estados definido. Su característica fundamental es la <strong>propiedad de no memoria</strong>, según la cual la probabilidad con la cual se visita el siguiente estado depende únicamente del estado actual, y no de la secuencia de eventos o estados anteriores.</p>
<p>Este tipo de modelos permite representar y analizar sistemas complejos bajo dichos supuestos, facilitando la comprensión de su comportamiento tanto a corto como a largo plazo. Gracias a ello, es posible anticipar escenarios futuros, optimizar decisiones y prevenir situaciones indeseadas.</p>
<section id="parte-1-ejercicio-guiado">
<h2>Parte 1: Ejercicio Guiado<a class="headerlink" href="#parte-1-ejercicio-guiado" title="Link to this heading">#</a></h2>
<p>RentBike es un servicio de alquiler de bicicletas el cual funciona en el área cercana a la zona universitaria del centro de la ciudad, con <span class="math notranslate nohighlight">\(30\)</span> bicicletas disponibles para alquiler. Las personas se acercan a este lugar y rentan bicicletas para su uso en lugares cercanos. Después de esto, los clientes las devuelven en el mismo lugar. La llegada de clientes al local de RentBike sigue un Proceso de Poisson con media de <span class="math notranslate nohighlight">\(5\)</span> personas por hora. Por otro lado, los clientes hacen uso de las bicicletas durante un tiempo que se distribuye exponencial con tasa de <span class="math notranslate nohighlight">\(9\)</span> personas por hora.</p>
<p>Para modelar cadenas de Markov en Python utilizaremos la librería <code class="docutils literal notranslate"><span class="pre">jmarkov</span></code>. Especificamente, ya que queremos modelar una cadena en tiempo <strong>continuo</strong>, usaremos el módulo <code class="docutils literal notranslate"><span class="pre">ctmc</span></code>. También usaremos <code class="docutils literal notranslate"><span class="pre">numpy</span></code> para el manejo general de matrices y vectores. Accedemos a ellas a continuación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">jmarkov.ctmc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ctmc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>Lo que caracteriza a una cadena de Markov son sus estados y su matriz de transición. Creemos estos elementos.</p>
<p>Nuestra variable de estado será $<span class="math notranslate nohighlight">\(X_t = \text{Número de bicicletas \textbf{alquiladas} en el instante } t.\)</span>$</p>
<p>Notemos que podríamos utilizar la variable complemento, donde se guarde el número de bicicletas disponibles a alquilar.</p>
<p>¡Anímate a intentarlo! ¿Cómo cambia la formulación?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definamos la capacidad máxima del sistema </span>
<span class="n">num_bicis</span> <span class="o">=</span> <span class="mi">30</span> 
<span class="c1"># Creemos el vector de estados</span>
<span class="n">estadosBicis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">num_bicis</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span> <span class="c1"># range(i,j) itera hasta j-1, así que para asegurarnos tener</span>
                                                           <span class="c1"># la capacidad máxima, sumamos 1 </span>
</pre></div>
</div>
</div>
</div>
<p>Ahora, crearemos la matriz de transiciones. Primero, crearemos una matriz llena de ceros y, a partir de la formulación general, la llenaremos por medio de ciclos y condicionales.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbb{Q}_{i\to j} = 
\begin{cases}
5, &amp; j=i+1 \quad i&lt;30, \\ 
9i, &amp; j=i-1 \quad i&gt;0,\\
0, &amp; \text{d.l.c}.
\end{cases}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creamos una matriz llena de ceros</span>
<span class="n">matrizBicis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">estadosBicis</span><span class="p">),</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">estadosBicis</span><span class="p">)))</span>

<span class="c1"># Recorremos sobre las filas (estado inicial)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">estadosBicis</span><span class="p">:</span>
    <span class="c1"># Recorremos sobre las columnas (estado futuro)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">estadosBicis</span><span class="p">:</span>
        <span class="c1"># Que alquilen una bici</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">30</span><span class="p">:</span>
            <span class="n">matrizBicis</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="c1"># Que devuelvan una bici </span>
        <span class="k">elif</span> <span class="n">j</span><span class="o">==</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">matrizBicis</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span><span class="o">*</span><span class="n">i</span> 
</pre></div>
</div>
</div>
</div>
<p>Para representar la tasa de permanencia en un estado, utilizamos la suma negativa de los otros posibles eventos iniciando en cierto estado. Así, llenemos la diagonal de la matriz.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Llenamos la diagonal</span>
<span class="c1"># Recorremos los estados</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">estadosBicis</span><span class="p">:</span>
    <span class="c1"># Donde la fila y la columna sean iguales (diagonal)</span>
    <span class="n">matrizBicis</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">matrizBicis</span><span class="p">[</span><span class="n">i</span><span class="p">,])</span>
</pre></div>
</div>
</div>
</div>
<p>Ahora, verifiquemos que la suma de las filas sea igual a 0. Esto es un paso importante para <code class="docutils literal notranslate"><span class="pre">debugging</span></code>, permite entender qué filas no están cumpliendo con las condiciones establecidas anteriormente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verificación de la suma de las filas </span>
<span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">matrizBicis</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])
</pre></div>
</div>
</div>
</div>
<p>Finalmente, estamos listos para crear el objeto cadena de Markov.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cadenaBicis</span> <span class="o">=</span> <span class="n">ctmc</span><span class="p">(</span><span class="n">matrizBicis</span><span class="p">,</span> <span class="n">estadosBicis</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">cadenaBicis</span><span class="o">.</span><span class="n">steady_state</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(0.9999999999765533)
</pre></div>
</div>
</div>
</div>
<p>Con el objeto creado, podemos utilizar todos los métodos de <code class="docutils literal notranslate"><span class="pre">jmarkov</span></code>. ¡Explóralos!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Para revisar que una cadena sea irreducible, devuelve True si es irreducible y False de lo contrario</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;¿La cadena es irreducible? </span><span class="si">{</span><span class="n">cadenaBicis</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Para revisar que una cadena sea ergódica, devuelve True si es ergódica y False de lo contrario</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;¿La cadena es ergódica? </span><span class="si">{</span><span class="n">cadenaBicis</span><span class="o">.</span><span class="n">is_ergodic</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Devuelve las probabilidades de estar en cada uno de los estados, en el largo plazo</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;¿Cuál es la probabilidad de estar en cada uno de los estados en el largo plazo? </span><span class="se">\n</span><span class="si">{</span><span class="n">cadenaBicis</span><span class="o">.</span><span class="n">steady_state</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;¿Cuál es la probabilidad de tener 10 bicis alquiladas o menos, en el largo plazo? </span><span class="se">\n</span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">cadenaBicis</span><span class="o">.</span><span class="n">steady_state</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">])</span><span class="si">:</span><span class="s1">.9%</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Devuelve las probabilidades de estar en cada uno de los estados, en t pasos y dado un vector de probabilidades iniciales</span>
<span class="n">probs_iniciales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">estadosBicis</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">estadosBicis</span><span class="p">))</span> <span class="c1"># Creamos un vector de probabilidades iniciales donde se está </span>
                                                                    <span class="c1"># en todos los estados equiprobablemente </span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">12</span> <span class="c1"># Queremos revisar cómo se comportará el número de bicis alquiladas en 12 horas</span>
<span class="n">probs_transitorio</span> <span class="o">=</span> <span class="n">cadenaBicis</span><span class="o">.</span><span class="n">transient_probabilities</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
                                                        <span class="n">alpha</span><span class="o">=</span><span class="n">probs_iniciales</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;¿Cuál es la probabilidad de que en </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1"> horas, estén todas las bicicletas alquiladas? </span><span class="se">\n</span><span class="si">{</span><span class="n">probs_transitorio</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span><span class="si">:</span><span class="s1">%</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>¿La cadena es irreducible? True
¿La cadena es ergódica? True
¿Cuál es la probabilidad de estar en cada uno de los estados en el largo plazo? 
[5.73753421e-01 3.18751900e-01 8.85421946e-02 1.63967027e-02
 2.27731982e-03 2.53035535e-04 2.34292162e-05 1.85946161e-06
 1.29129278e-07 7.97094313e-09 4.42830196e-10 2.23651757e-11
 1.03543910e-12 4.42597348e-14 1.76421378e-15 6.93889390e-17
 6.93889390e-18 6.93889390e-18 5.20417043e-18 3.46944695e-18
 1.73472348e-18 1.73472348e-18 0.00000000e+00 1.73472348e-18
 0.00000000e+00 0.00000000e+00 0.00000000e+00 1.73472348e-18
 1.73472348e-18 0.00000000e+00 1.73472348e-18]
¿Cuál es la probabilidad de tener 10 bicis alquiladas o menos, en el largo plazo? 
99.999999998%
¿Cuál es la probabilidad de que en 12 horas, estén todas las bicicletas alquiladas? 
0.000000%
</pre></div>
</div>
</div>
</div>
</section>
<section id="parte-2-ejercicio-aplicado">
<h2>Parte 2: Ejercicio Aplicado<a class="headerlink" href="#parte-2-ejercicio-aplicado" title="Link to this heading">#</a></h2>
<p>En una estación de control fronterizo se realiza la <span class="math notranslate nohighlight">\(\textbf{inspección y registro de viajeros}\)</span> que ingresan al país. Los viajeros llegan al punto de control, con una tasa promedio de <span class="math notranslate nohighlight">\(\lambda = 10\)</span> personas por hora, y deben pasar por <span class="math notranslate nohighlight">\(\textbf{dos etapas sucesivas}\)</span>:</p>
<p>Todos los pasajeros que llegan pasan por una verificación automática de documentos, en la que cada viajero escanea su pasaporte y formulario digital en una máquina de autogestión o por medio de su teléfono móvil. El tiempo de servicio en esta estación tiene una media de <span class="math notranslate nohighlight">\(5\)</span> minutos.</p>
<p>Luego de la verificación de documentos, se realiza una inspección por parte de un oficial migratorio. El tiempo promedio de atención es de <span class="math notranslate nohighlight">\(4\)</span> minutos  y hay tres oficiales disponibles.
Una vez atendidos, el <span class="math notranslate nohighlight">\(80\%\)</span> de los viajeros sale del sistema y el <span class="math notranslate nohighlight">\(20\%\)</span> es enviado nuevamente a la inspección manual para revisión complementaria.</p>
<p>Se desea evaluar el desempeño del sistema teniendo en cuenta que la estación de control fronterizo <span class="math notranslate nohighlight">\(\textbf{tiene una capacidad máxima de 50 personas}\)</span>.</p>
<p>A continuación, se encuentra una gráfica del proceso de control fronterizo.</p>
<img src="../../_static/cmtc_imagenes/red.png" width="800"><p>Igual que en el ejercicio anterior, caracterizamos a la cadena por sus estados y matriz de transiciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definimos la capacidad máxima del sistema</span>
<span class="n">capacidad_maxima</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># Definimos los posibles valores de los espacios de estados individuales</span>
<span class="n">estados_VA</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">capacidad_maxima</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">estados_I</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">capacidad_maxima</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>

<span class="c1"># Creamos una lista para guardar el espacio de estados conjunto</span>
<span class="n">estados_conjunto</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Recorremos todos los posibles estados de Verificación Automática (VA) e Inspección (I)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">estados_VA</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">estados_I</span><span class="p">:</span>
        <span class="c1"># Verificamos que el estado sea factible </span>
        <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="n">j</span> <span class="o">&lt;=</span> <span class="n">capacidad_maxima</span><span class="p">:</span>
            <span class="c1"># Agregamos el estado a nuestra lista de estados conjunto</span>
            <span class="n">estados_conjunto</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Guardamos el conjunto de estados como un np.array</span>
<span class="n">estados_conjunto</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">estados_conjunto</span><span class="p">)</span>
<span class="n">estados_conjunto</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;0,0&#39;, &#39;0,1&#39;, &#39;0,2&#39;, ..., &#39;49,0&#39;, &#39;49,1&#39;, &#39;50,0&#39;],
      shape=(1326,), dtype=&#39;&lt;U5&#39;)
</pre></div>
</div>
</div>
</div>
<p>Luego, creamos y llenamos la matriz de transiciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creamos una matriz llena de ceros con tantas filas y columnas como estados factibles</span>
<span class="n">matrizQ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">estados_conjunto</span><span class="p">),</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">estados_conjunto</span><span class="p">)))</span>

<span class="c1"># Llenamos la matriz, de acuerdo con la formulación general</span>
<span class="c1"># Recorremos sobre las filas </span>
<span class="k">for</span> <span class="n">fila</span><span class="p">,</span> <span class="n">estado_inicial</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">estados_conjunto</span><span class="p">):</span>
    <span class="c1"># Recuperamos los índices</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">estado_inicial</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">estado_inicial</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Recorremos sobre las columnas</span>
    <span class="k">for</span> <span class="n">columna</span><span class="p">,</span> <span class="n">estado_futuro</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">estados_conjunto</span><span class="p">):</span>
        <span class="c1"># Recuperamos los índices</span>
        <span class="n">i_</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">estado_futuro</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">j_</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">estado_futuro</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># Que llegue una persona a Verificación Automática, cuando hay espacio en el sistema</span>
        <span class="k">if</span> <span class="n">i_</span><span class="o">==</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">j_</span><span class="o">==</span><span class="n">j</span> <span class="ow">and</span> <span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">&lt;</span><span class="n">capacidad_maxima</span><span class="p">:</span>
            <span class="n">matrizQ</span><span class="p">[</span><span class="n">fila</span><span class="p">,</span><span class="n">columna</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span>
        <span class="c1"># Que salga una persona de Verificación Automática y entre a Inspección</span>
        <span class="k">elif</span> <span class="n">i_</span><span class="o">==</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">j_</span><span class="o">==</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">matrizQ</span><span class="p">[</span><span class="n">fila</span><span class="p">,</span><span class="n">columna</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span>
        <span class="c1"># Que salga una persona de Inspección, fuera del sistema</span>
        <span class="k">elif</span> <span class="n">i_</span><span class="o">==</span><span class="n">i</span> <span class="ow">and</span> <span class="n">j_</span><span class="o">==</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">j</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">matrizQ</span><span class="p">[</span><span class="n">fila</span><span class="p">,</span><span class="n">columna</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.8</span><span class="o">*</span><span class="nb">min</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Llenamos la diagonal</span>
<span class="c1"># Recorremos sobre las filas</span>
<span class="k">for</span> <span class="n">fila</span><span class="p">,</span> <span class="n">estado_inicial</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">estados_conjunto</span><span class="p">):</span>
    <span class="n">matrizQ</span><span class="p">[</span><span class="n">fila</span><span class="p">,</span><span class="n">fila</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nb">sum</span><span class="p">(</span><span class="n">matrizQ</span><span class="p">[</span><span class="n">fila</span><span class="p">,:])</span>

<span class="c1"># Verificamos la suma de las filas </span>
<span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">matrizQ</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Creamos el objeto cadena de Markov</span>
<span class="n">cadena_continua</span> <span class="o">=</span> <span class="n">ctmc</span><span class="p">(</span><span class="n">matrizQ</span><span class="p">,</span>
                       <span class="n">estados_conjunto</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ya que tenemos el objeto cadena de Markov, podemos utilizar todos sus métodos. Probemos algunos de ellos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Revisemos si es irreducile</span>
<span class="n">cadena_continua</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>

<span class="c1"># Revisemos si es ergódica</span>
<span class="n">cadena_continua</span><span class="o">.</span><span class="n">is_ergodic</span><span class="p">()</span>

<span class="c1"># Revisemos el número de estados</span>
<span class="n">cadena_continua</span><span class="o">.</span><span class="n">n_states</span>

<span class="c1"># Veamos las probabilidades en el transitorio (cuando t=15)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">estados_conjunto</span><span class="p">))</span>
<span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">cadena_continua</span><span class="o">.</span><span class="n">transient_probabilities</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                                        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

<span class="c1"># Veamos las probabilidades en estado estable</span>
<span class="n">cadena_continua</span><span class="o">.</span><span class="n">steady_state</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([7.20299989e-02, 6.00249991e-02, 2.50104163e-02, ...,
       9.49800408e-06, 7.91500340e-06, 7.91500340e-06], shape=(1326,))
</pre></div>
</div>
</div>
</div>
<section id="preguntas-de-profundizacion">
<h3>Preguntas de Profundización<a class="headerlink" href="#preguntas-de-profundizacion" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>¿Qué tipo de sistemas se puede modelar como una cadena de Markov en tiempo continuo?</p></li>
<li><p>¿Por qué es útil crear cadenas como objetos cadenas de Markov? ¿Por qué no basta con solo tener la matriz de transición?</p></li>
<li><p>¿Cómo cambia el sistema si se cambia su capacidad?</p></li>
<li><p>¿Cómo cambia se se modifican sus tasas de entrada y servicio? ¿Qué tal si se cambian el número de servidores?</p></li>
</ul>
<p>Universidad de los Andes | Vigilada Mineducación. Reconocimiento como Universidad: Decreto 1297 del 30 de mayo de 1964. Reconocimiento personería jurídica: Resolución 28 del 23 de febrero de 1949 Minjusticia. Departamento de Ingeniería Industrial Carrera 1 Este No. 19 A 40 Bogotá, Colombia Tel. (57.1) 3324320 | (57.1) 3394949 Ext. 2880 /2881 <a class="reference external" href="http://industrial.uniandes.edu.co">http://industrial.uniandes.edu.co</a></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "entorno"
        },
        kernelOptions: {
            name: "entorno",
            path: "./content\complementarias"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'entorno'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="complementaria_filas.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Complementaria 5: Cálculo de filas</p>
      </div>
    </a>
    <a class="right-next"
       href="complementaria_simu_proceso_poisson.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Complementaria Semana 8: Simulación de un Proceso de Poisson</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parte-1-ejercicio-guiado">Parte 1: Ejercicio Guiado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parte-2-ejercicio-aplicado">Parte 2: Ejercicio Aplicado</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preguntas-de-profundizacion">Preguntas de Profundización</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Equipo Modelado Bajo Incertidumbre | Uniandes
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>